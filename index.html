<!doctype html><html lang="ru"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>PYC5</title><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"/><script type="module" crossorigin>(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerpolicy&&(o.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?o.credentials="include":a.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=s(a);fetch(a.href,o)}})();const c=()=>`<div class="login">
<main class="form-signin w-100 m-auto">
<div class="form-floating">
<input id="login-username" class="form-control" list="users" type="name" placeholder="Имя" onclick="document.getElementById('login-label').style = 'color:initial'" required />
<label id="login-label">Имя</label>
<datalist id="users">
<option value="Агеенко Александра">
<option value="Баданин Макар">
<option value="Баченков Александр">
<option value="Бродзинская Анастасия">
<option value="Василькова Оксана">
<option value="Дирвонскис Денис">
<option value="Дирвонскис Кирилл">
<option value="Ермакова Анна">
<option value="Лехнер Иван">
<option value="Лысенко Анастасия">
<option value="Мелеш Егор">
<option value="Нам Владимир">
<option value="Семенова Алина">
<option value="Тихонов Егор">
</datalist>
</div>
<button class="w-100 btn btn-lg btn-primary" onclick="window.start()">Вход</button>
</main>
</div>`,u=e=>`<header class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow">
<a class="navbar-brand col-md-3 col-lg-2 me-0 px-3 fs-6" href="#">${e.username}</a>
<button
class="navbar-toggler position-absolute d-md-none collapsed"
type="button"
data-bs-toggle="collapse"
data-bs-target="#sidebarMenu"
aria-controls="sidebarMenu"
aria-expanded="false"
aria-label="Toggle navigation">
<span class="navbar-toggler-icon"></span>
</button>
<div class="navbar-nav">
<div class="nav-item text-nowrap">
<a class="nav-link px-3" href="#" onclick="window.logout()">Выход</a>
</div>
</div>
</header>
<div class="container-fluid">
<div class="row">
${e.admin?`<nav class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
<div class="position-sticky pt-3 sidebar-sticky">
<ul class="nav flex-column">
<li class="nav-item">
<a class="nav-link active" aria-current="page" href="#" id="tests-link" onclick="window.start('${e.username}')">
<span data-feather="book-open" class="align-text-bottom"></span>
Тесты
</a>
</li>
<li class="nav-item">
<a class="nav-link" aria-current="page" href="#" id="results-link" onclick="window.results()">
<span data-feather="table" class="align-text-bottom"></span>
Результаты
</a>
</li>
</ul>
</div>
</nav>`:""}
<main ${e.admin?'class="col-md-9 ms-sm-auto col-lg-10 px-md-4"':""}>
<div class="m-3" id="page">
</div>
</main>
</div>
</div>`,p=e=>`<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 list-group">
<h1>${e.testName} (${e.variant+1})</h1>
<div>${e.questions.map((t,s)=>`<div class="list-group list-group-checkable mt-3 mb-3 d-grid gap-2 border-0 w-auto">
<h4 style="background: #bdbdbd; padding: 1em; border-radius: 10px;">${s+1}. ${t.question}</h4>
${t.answers.map((n,a)=>`<input class="list-group-item-check pe-none" type="${t.type}" name="test-answer-${s}" id="test-answer-${s}-${a}" value="" onclick="window.select(${s}, ${a}, '${t.type}')" />
<label class="list-group-item rounded-3 py-3" for="test-answer-${s}-${a}">${n}</label>`).join("")}</div>`).join("")}</div>
<a href="#" onclick="window.finish()" class="w-50 btn btn-primary btn-lg">Готово!</a>
</div>`,d=e=>`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`,m=e=>`${e.getFullYear()}/${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getDate().toString().padStart(2,"0")}`,g=e=>(console.log(e),`<h1>Результаты</h1>
<table class="table table-striped table-sm">
<thead>
<tr>
<th>Тест</th>
<th>Вариант</th>
<th>Имя</th>
<th>Дата</th>
<th>Начало</th>
<th>Конец</th>
<th>Время</th>
<th>Оценка</th>
<th>Фокус</th>
</tr>
</thead>
<tbody>${e.map((t,s)=>`<tr class="" id="result-${s}" onclick="window.viewResult(${s})" style="cursor:pointer">
<td>${t.testName}</td>
<td>${t.variant+1}</td>
<td>${t.username}</td>
<td>${m(new Date(t.start))}</td>
<td>${d(new Date(t.start))}</td>
<td>${d(new Date(t.end))}</td>
<td>${Math.round((t.end-t.start)/1e3/60)} мин.</td>
<td>${t.score}/${t.questions.length}</td>
<td>${Math.round(100*t.stats.focus[!0]/t.stats.samples)}% (${t.stats.focus[!1]||0} сек. мимо)</td>
</tr>`).join("")}</tbody>
</table>
<div id="result-viewer" class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 list-group">
</div>`),w=(e,t)=>e.rightAnswers.includes(t)&&e.selected.includes(t)?'style="background:#b9f6ca"':e.rightAnswers.includes(t)&&!e.selected.includes(t)?'style="background:#ffd180"':!e.rightAnswers.includes(t)&&e.selected.includes(t)?'style="background:#ff8a80"':"",h=e=>`<h1>${e.username}</h1>
<h2>${e.testName} (${e.variant+1})</h2>
<div>${e.questions.map((t,s)=>`<div class="list-group mt-3 mb-3 d-grid gap-2 border-0 w-auto">
<h4 style="background: #bdbdbd; padding: 1em; border-radius: 10px;">${s+1}. ${t.question}</h4>
${t.answers.map((n,a)=>`<label class="list-group-item rounded-3 py-3" ${w(t,a)}>${n}</label>`).join("")}</div>`).join("")}</div>`,b=()=>`<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 list-group">
<h1>Тест выполнен!</h1>
</div>`,l=(e,t,...s)=>document.getElementById(e||"app").innerHTML=t(...s),v="https://sweet-moth-32.deno.dev",r=async(e,t={})=>await(await fetch(`${v}/${e}`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)})).json();window.viewResult=e=>{const t=window.data[e];console.log(e);for(let s=0;s<window.data.length;++s)document.getElementById(`result-${s}`).attributes.class.value="";document.getElementById(`result-${e}`).attributes.class.value="highlighted",l("result-viewer",h,t)};window.results=async()=>{const{data:e,error:t}=await r("results",{username:window.data.username});t||(l("page",g,e),document.getElementById("tests-link").attributes.class.value="nav-link",document.getElementById("results-link").attributes.class.value="nav-link active",window.data=e)};window.logout=()=>{clearInterval(window.watcher),delete window.data,localStorage.removeItem("username"),l("app",c)};window.start=async e=>{if(!e&&(e=document.getElementById("login-username").value,!e)){document.getElementById("login-username").reportValidity();return}const t=await r("start",{username:e});if(t.error){document.getElementById("login-username").value="",document.getElementById("login-label").style="color:red";return}localStorage.setItem("username",e),t.username=e,t.start=+new Date,t.questions.forEach(s=>s.selected={}),l("app",u,t),l("page",p,t),t.stats={focus:{},width:{},height:{},samples:0},window.watcher=setInterval(()=>{const s=Math.round(window.innerWidth/window.screen.width*10)/10,n=Math.round(window.innerHeight/window.screen.height*10)/10,a=document.hasFocus();++t.stats.samples,t.stats.width[s]=t.stats.width[s]||0,++t.stats.width[s],t.stats.height[n]=t.stats.height[n]||0,++t.stats.height[n],t.stats.focus[a]=t.stats.focus[a]||0,++t.stats.focus[a]},1e3),window.data=t};window.select=(e,t,s)=>{const n=window.data;s==="radio"?(n.questions[e].selected={},n.questions[e].selected[t]=!0):(n.questions[e].selected=n.questions[e].selected||{},n.questions[e].selected[t]?delete n.questions[e].selected[t]:n.questions[e].selected[t]=!0)};window.finish=async()=>{const e=window.data;e.questions.forEach(t=>t.selected=Object.keys(t.selected).map(Number)),e.end=+new Date,await r("finish",{data:e}),l("page",b),clearInterval(window.watcher)};localStorage.getItem("username")?start(localStorage.getItem("username")):l("app",c);</script><style>#app,body,html{height:100%}.login{height:100%;display:flex;align-items:center;padding-top:40px;padding-bottom:40px;background-color:#f5f5f5}.form-signin{max-width:330px;padding:15px}.form-signin .form-floating:focus-within{z-index:2}.form-signin input[type=name]{margin-bottom:10px}.form-signin input[type=password]{margin-bottom:10px;border-top-left-radius:0;border-top-right-radius:0}.list-group{max-width:100%;margin:4rem auto}.form-check-input:checked+.form-checked-content{opacity:.5}.form-check-input-placeholder{border-style:dashed}[contenteditable]:focus{outline:0}.list-group-checkable .list-group-item{cursor:pointer}.list-group-item-check{position:absolute;clip:rect(0,0,0,0)}.list-group-item-check:hover+.list-group-item{background-color:var(--bs-light)}.list-group-item-check:checked+.list-group-item{color:#fff;background-color:var(--bs-blue)}.list-group-item-check:disabled+.list-group-item,.list-group-item-check[disabled]+.list-group-item{pointer-events:none;filter:none;opacity:.5}.list-group-radio .list-group-item{cursor:pointer;border-radius:.5rem}.list-group-radio .form-check-input{z-index:2;margin-top:-.5em}.list-group-radio .list-group-item:focus,.list-group-radio .list-group-item:hover{background-color:var(--bs-light)}.list-group-radio .form-check-input:checked+.list-group-item{background-color:var(--bs-body);border-color:var(--bs-blue);box-shadow:0 0 0 2px var(--bs-blue)}.list-group-radio .form-check-input:disabled+.list-group-item,.list-group-radio .form-check-input[disabled]+.list-group-item{pointer-events:none;filter:none;opacity:.5}.b-example-divider,.divider{height:3rem;background-color:#0000001a;border:solid rgba(0,0,0,.15);border-width:1px 0;box-shadow:inset 0 .5em 1.5em #0000001a,inset 0 .125em .5em #00000026}.b-example-vr{flex-shrink:0;width:1.5rem;height:100vh}.feather{width:16px;height:16px}.sidebar{position:fixed;top:0;bottom:0;left:0;z-index:100;padding:48px 0 0;box-shadow:inset -1px 0 #0000001a}@media (max-width:767.98px){.sidebar{top:5rem}}.sidebar-sticky{height:calc(100vh - 48px);overflow-x:hidden;overflow-y:auto}.sidebar .nav-link{font-weight:500;color:#333}.sidebar .nav-link .feather{margin-right:4px;color:#727272}.sidebar .nav-link.active{color:#2470dc}.sidebar .nav-link.active .feather,.sidebar .nav-link:hover .feather{color:inherit}.sidebar-heading{font-size:.75rem}.navbar-brand{padding-top:.75rem;padding-bottom:.75rem;background-color:#00000040;box-shadow:inset -1px 0 #00000040}.navbar .navbar-toggler{top:.25rem;right:1rem}.navbar .form-control{padding:.75rem 1rem}.form-control-dark{color:#fff;background-color:#ffffff1a;border-color:#ffffff1a}.form-control-dark:focus{border-color:transparent;box-shadow:0 0 0 3px #ffffff40}a.disabled{color:gray!important;pointer-events:none}.highlighted{background-color:#ddd}.list-group-item+.list-group-item{border-top-width:1px!important}</style></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="app"></div></body></html>